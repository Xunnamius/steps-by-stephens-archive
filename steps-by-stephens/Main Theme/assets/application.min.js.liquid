+function($){"use strict";function clearMenus(e){e&&3===e.which||($(backdrop).remove(),$(toggle).each(function(){var $parent=getParent($(this)),relatedTarget={relatedTarget:this};$parent.hasClass("open")&&($parent.trigger(e=$.Event("hide.bs.dropdown",relatedTarget)),e.isDefaultPrevented()||$parent.removeClass("open").trigger("hidden.bs.dropdown",relatedTarget))}))}function getParent($this){var selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&/#[A-Za-z]/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=selector&&$(selector);return $parent&&$parent.length?$parent:$this.parent()}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.dropdown");data||$this.data("bs.dropdown",data=new Dropdown(this)),"string"==typeof option&&data[option].call($this)})}var backdrop=".dropdown-backdrop",toggle='[data-toggle="dropdown"]',Dropdown=function(element){$(element).on("click.bs.dropdown",this.toggle)};Dropdown.VERSION="3.2.0",Dropdown.prototype.toggle=function(e){var $this=$(this);if(!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(clearMenus(),!isActive){"ontouchstart"in document.documentElement&&!$parent.closest(".navbar-nav").length&&$('<div class="dropdown-backdrop"/>').insertAfter($(this)).on("click",clearMenus);var relatedTarget={relatedTarget:this};if($parent.trigger(e=$.Event("show.bs.dropdown",relatedTarget)),e.isDefaultPrevented())return;$this.trigger("focus"),$parent.toggleClass("open").trigger("shown.bs.dropdown",relatedTarget)}return!1}},Dropdown.prototype.keydown=function(e){if(/(38|40|27)/.test(e.keyCode)){var $this=$(this);if(e.preventDefault(),e.stopPropagation(),!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(!isActive||isActive&&27==e.keyCode)return 27==e.which&&$parent.find(toggle).trigger("focus"),$this.trigger("click");var desc=" li:not(.divider):visible a",$items=$parent.find('[role="menu"]'+desc+', [role="listbox"]'+desc);if($items.length){var index=$items.index($items.filter(":focus"));38==e.keyCode&&index>0&&index--,40==e.keyCode&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).trigger("focus")}}}};var old=$.fn.dropdown;$.fn.dropdown=Plugin,$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.bs.dropdown.data-api",clearMenus).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.bs.dropdown.data-api",toggle+', [role="menu"], [role="listbox"]',Dropdown.prototype.keydown)}(jQuery),Element.implement({isFullyVisible:function(){if(this.isVisible()){var coord=this.getCoordinates(),winScroll=window.getScroll();return winScroll.y<=coord.top}return!1},isPartiallyVisible:function(){if(this.isVisible()){var coord=this.getCoordinates(),winScroll=window.getScroll();return winScroll.y<=coord.bottom}return!1}});var SLIDESHOW_PROPERTIES={interim_delay:6e3+Number.random(-3e3,2e3),initial_delay_ignore_threshold:4,tween_lower_bound:.15,tween_upper_bound:.75,transition_duration:350},BOOTSTRAP_GRID_BREAKPOINT=768,BOOTSTRAP_DEFAULT_SECTION_PADDING=75,LOOKBOOK_COMPUTED_STYLES={styles:["margin"]};~function($){var smoothscroll=null,brand=$$(".navbar-brand")[0],atIndex=!!$$(".template-index")[0],initialized=!1,slideshow=null;atIndex&&(slideshow=$("slideshow"),slideshow.loading=slideshow.getElement(".loading"),slideshow.canvas=slideshow.getElement("img"),slideshow.container=slideshow.getElement(".container"),slideshow.properties=SLIDESHOW_PROPERTIES,slideshow.setImg=function(img){slideshow.canvas.set("src",img)},slideshow.getImg=function(){return slideshow.canvas.getProperty("src")},slideshow.canvas.set("alt","Product image failed to load!"));var getSizes=function(child){var parentSize=child.getParent()==document.body?window.getSize():child.getParent().getDimensions(),childSize=child.getDimensions();return[parentSize,childSize]};window.addEvent("resize",function(){var xy=window.getSize();$$(".viewport-sized").each(function(el){el.setStyles({width:xy.x,height:xy.y})}),$$(".vertical-center").each(function(child){var sizes=getSizes(child),parentSize=sizes[0],childSize=sizes[1];child.setStyles({display:"block",top:(parentSize.y-childSize.y)/2})}),$$(".horizontal-center").each(function(child){var sizes=getSizes(child),parentSize=sizes[0],childSize=sizes[1];child.setStyles({display:"block",left:(parentSize.x-childSize.x)/2})}),$$(".absolute-center").each(function(child){var sizes=getSizes(child),parentSize=sizes[0],childSize=sizes[1];child.setStyles({display:"block",left:(parentSize.x-childSize.x)/2,top:(parentSize.y-childSize.y)/2})}),xy.x<BOOTSTRAP_GRID_BREAKPOINT?(smoothscroll&&smoothscroll.setOptions({offset:{x:0,y:-81}}),$$(".collapse .navbar-nav a").each(function(a){"#"==a.get("href").charAt(0)&&(a.setAttribute("data-toggle","collapse"),a.setAttribute("data-target","#navbar-collapse"))})):(smoothscroll&&smoothscroll.setOptions({offset:{x:0,y:-64}}),$$(".collapse .navbar-nav a").each(function(a){"#"==a.get("href").charAt(0)&&(a.setAttribute("data-toggle",""),a.setAttribute("data-target",""))})),$("content").setStyle("padding-bottom",$$("footer")[0].getSize().y+BOOTSTRAP_DEFAULT_SECTION_PADDING)}).fireEvent("resize"),atIndex&&(brand.store("data-toggle",brand.get("data-toggle")),window.addEvent("scroll",function(){slideshow.container.isPartiallyVisible()?($$("nav.navbar").removeClass("navbar-inverse"),brand.setAttribute("data-toggle",brand.retrieve("data-toggle"))):($$("nav.navbar").addClass("navbar-inverse"),brand.removeAttribute("data-toggle"))}).fireEvent("scroll"),$$("#slideshow .container a").each(function(item){item.getElement("span").set("morph",{duration:250,link:"cancel"}),item.addEvent("mouseenter",function(){this.getElement("span").morph({width:220,height:220,top:-170,left:-50})}),item.addEvent("mouseleave",function(){this.getElement("span").morph({width:0,height:0,top:-62,left:55})})})),$$('a[href*="///"]').each(function(a){a.set("href",a.get("href").substring(atIndex?3:2))}),smoothscroll=new Fx.SmoothScroll({links:'a[href*="#"]',wheelStops:!1,offset:{x:0,y:-64}});var err=function(errorText){atIndex&&slideshow.loading.addClass("error").set("text","XHR Error (see console). Please report this glitch!"),window.console.error(errorText)};atIndex?imgdata.length?Asset.image(imgdata[0].img,{onError:function(){err("Error loading initial image.")},onLoad:function(){var loadtime=new Date;slideshow.loading.addClass("hidden"),slideshow.container.getElement(".hidden").removeClass("hidden"),window.fireEvent("resize"),slideshow.setImg(imgdata[0].img),window.fireEvent("resize"),slideshow.canvas.get("tween").start("opacity",slideshow.properties.tween_upper_bound).chain(function(){loadtime=new Date,slideshow.canvas.set("tween",{duration:slideshow.properties.transition_duration,transition:"expo:in:out",link:"cancel",property:"opacity"})});var imgdataRaw=imgdata.map(function(data){return data.img});Asset.images(imgdataRaw.slice(1),{onError:function(c,i,s){err("Error processing gallery image #{0} (index {1}): {2}".substitute({0:c,1:i,2:s||"(no source)"}))},onComplete:function(){var imgdataShuffled=imgdataRaw.shuffle(),ticker=function(){var randimg,backimg=slideshow.getImg();do randimg=imgdataShuffled.getRandom();while(imgdataShuffled.length>1&&randimg==backimg);slideshow.canvas.get("tween").start(slideshow.properties.tween_lower_bound).chain(function(){slideshow.setImg(randimg),slideshow.canvas.tween(slideshow.properties.tween_upper_bound)})},thresh=slideshow.properties.initial_delay_ignore_threshold;(loadtime.valueOf()-(new Date).valueOf())/1e3>thresh&&ticker(),ticker.periodical(slideshow.properties.interim_delay),initialized=!0,window.fireEvent("scroll")}})}}):err("Server returned no image data?!"):initialized=!0,$$("[data-toggle]").addEvent("click",function(){$$(".no-click").removeClass("no-click")}),$$(".lookbook-control").each(function(control){control.addEvent("click",function(e){e.stop();var target=$$(this.get("data-lookbook-target"))[0];if(target.retrieve("data-lookbook-started")&&!target.isMoving){var row=target.getElement(".lookbook-inner-row"),moveam=target.retrieve("data-lookbook-moveam"),current=target.retrieve("data-lookbook-current"),total=row.retrieve("numberOfElements"),left="left"==this.get("data-lookbook-direction");left&&0>=current||!left&&current>=total-1||(target.isMoving=!0,row.get("tween").chain(function(){target.isMoving=!1}).start("left",row.getStyle("left").toInt()+(left?moveam:-moveam)),function(){target.isMoving=!1}.delay(500),target.store("data-lookbook-current",left?current-1:current+1))}})}),$$(".lookbook-row-wrapper").each(function(wrapper){wrapper.resetPosition=function(moveToCurrentElement){var row=wrapper.getElement(".lookbook-inner-row"),item=wrapper.getElement("a:first-child"),itemOuterWidth=item.getComputedSize(LOOKBOOK_COMPUTED_STYLES).totalWidth,startam=(wrapper.getComputedSize(LOOKBOOK_COMPUTED_STYLES).totalWidth-item.getComputedSize(LOOKBOOK_COMPUTED_STYLES).totalWidth)/2;if(wrapper.isFullyVisible()){var starton=wrapper.get("data-lookbook-starton")||0;"middle"==starton&&(starton=(row.retrieve("numberOfElements")/2).floor()),starton=starton.toInt(),wrapper.addClass("no-scroll");var current=wrapper.retrieve("data-lookbook-current"),moveto=moveToCurrentElement&&null!==current?current:starton,fx=row.get("tween");fx.chain(function(){wrapper.store("data-lookbook-started",!0),wrapper.store("data-lookbook-current",moveto),fx.clearChain()}).start("left",startam-itemOuterWidth*moveto),function(){wrapper.store("data-lookbook-started",!0).store("data-lookbook-current",moveto)}.delay(500),wrapper.store("data-lookbook-moveam",itemOuterWidth)}}}),$$(".lookbook-inner-row").each(function(row){var numberOfElements=row.getElements(".thumbnail").length;row.set("tween",{link:"ignore"}).store("numberOfElements",numberOfElements).setStyle("min-width",row.getElement(".thumbnail").getComputedSize(LOOKBOOK_COMPUTED_STYLES).totalWidth*numberOfElements);var imagesToLoad=[];row.getElements(".thumbnail").each(function(thumb){thumb.set("title","Give us a sec while we load an HD version of this image...").addClass("wait").store("ready",!1),imagesToLoad.push(thumb.getElement("img").get("data-img-master")),thumb.addEvent("click",function(e){e.stop(),this.retrieve("ready")&&($("overlay-img").set("src",this.getElement("img").get("data-img-master")),window.fireEvent("resize"),$("overlay").removeClass("invis"),function(){window.fireEvent("resize")}.delay(250))})}),Asset.images(imagesToLoad,{onError:function(c,i,s){err("Error processing lookbook image #{0} (index {1}): {2}".substitute({0:c,1:i,2:s||"(no source)"}))},onProgress:function(counter,index,source){$$('img[data-img-master="//'+source.split("//").getLast()+'"] !> .thumbnail').store("ready",!0).removeClass("wait").set("title","Click for a larger image")}})}),window.addEvent("scroll",function(){initialized&&$$(".lookbook-row-wrapper:not(.no-scroll)").each(function(wrapper){wrapper.resetPosition(!1)})}).addEvent("resize",function(){initialized&&$$(".lookbook-row-wrapper").each(function(wrapper){wrapper.resetPosition(!0)})}),window.addEvent("scroll",function(){$("overlay").addClass("invis")}),$("overlay").addEvent("click",function(e){e.stop(),this.addClass("invis")}),function(){window.fireEvent("resize").fireEvent("scroll")}.delay(250)}(document.id);